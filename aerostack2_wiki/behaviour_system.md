Relevant source files

-   [as2\_behaviors/as2\_behaviors\_motion/follow\_path\_behavior/plugins/follow\_path\_plugin\_trajectory.cpp](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_motion/follow_path_behavior/plugins/follow_path_plugin_trajectory.cpp)
-   [as2\_behaviors/as2\_behaviors\_motion/go\_to\_behavior/plugins/go\_to\_plugin\_trajectory.cpp](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_motion/go_to_behavior/plugins/go_to_plugin_trajectory.cpp)
-   [as2\_behaviors/as2\_behaviors\_motion/land\_behavior/plugins/land\_plugin\_trajectory.cpp](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_motion/land_behavior/plugins/land_plugin_trajectory.cpp)
-   [as2\_behaviors/as2\_behaviors\_motion/takeoff\_behavior/plugins/takeoff\_plugin\_trajectory.cpp](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_motion/takeoff_behavior/plugins/takeoff_plugin_trajectory.cpp)
-   [as2\_behaviors/as2\_behaviors\_perception/CMakeLists.txt](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/CMakeLists.txt)
-   [as2\_behaviors/as2\_behaviors\_perception/detect\_aruco\_markers\_behavior/include/detect\_aruco\_markers\_behavior/detect\_aruco\_markers\_behavior.hpp](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/detect_aruco_markers_behavior/include/detect_aruco_markers_behavior/detect_aruco_markers_behavior.hpp)
-   [as2\_behaviors/as2\_behaviors\_perception/detect\_aruco\_markers\_behavior/launch/detect\_aruco\_markers\_behavior\_real\_launch.py](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/detect_aruco_markers_behavior/launch/detect_aruco_markers_behavior_real_launch.py)
-   [as2\_behaviors/as2\_behaviors\_perception/detect\_aruco\_markers\_behavior/launch/detect\_aruco\_markers\_behavior\_sim\_launch.py](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/detect_aruco_markers_behavior/launch/detect_aruco_markers_behavior_sim_launch.py)
-   [as2\_behaviors/as2\_behaviors\_perception/detect\_aruco\_markers\_behavior/src/detect\_aruco\_markers\_behavior.cpp](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/detect_aruco_markers_behavior/src/detect_aruco_markers_behavior.cpp)
-   [as2\_behaviors/as2\_behaviors\_perception/detect\_aruco\_markers\_behavior/src/detect\_aruco\_markers\_behavior\_node.cpp](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/detect_aruco_markers_behavior/src/detect_aruco_markers_behavior_node.cpp)
-   [as2\_behaviors/as2\_behaviors\_perception/point\_gimbal\_behavior/CMakeLists.txt](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/point_gimbal_behavior/CMakeLists.txt)
-   [as2\_behaviors/as2\_behaviors\_perception/point\_gimbal\_behavior/config/config\_default.yaml](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/point_gimbal_behavior/config/config_default.yaml)
-   [as2\_behaviors/as2\_behaviors\_perception/point\_gimbal\_behavior/include/point\_gimbal\_behavior/point\_gimbal\_behavior.hpp](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/point_gimbal_behavior/include/point_gimbal_behavior/point_gimbal_behavior.hpp)
-   [as2\_behaviors/as2\_behaviors\_perception/point\_gimbal\_behavior/launch/point\_gimbal\_behavior.launch.py](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/point_gimbal_behavior/launch/point_gimbal_behavior.launch.py)
-   [as2\_behaviors/as2\_behaviors\_perception/point\_gimbal\_behavior/src/point\_gimbal\_behavior.cpp](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/point_gimbal_behavior/src/point_gimbal_behavior.cpp)
-   [as2\_behaviors/as2\_behaviors\_perception/point\_gimbal\_behavior/src/point\_gimbal\_behavior\_node.cpp](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/point_gimbal_behavior/src/point_gimbal_behavior_node.cpp)
-   [as2\_behaviors/as2\_behaviors\_perception/point\_gimbal\_behavior/tests/CMakeLists.txt](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/point_gimbal_behavior/tests/CMakeLists.txt)
-   [as2\_behaviors/as2\_behaviors\_perception/point\_gimbal\_behavior/tests/point\_gimbal\_gtest.cpp](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/point_gimbal_behavior/tests/point_gimbal_gtest.cpp)
-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/CMakeLists.txt](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/CMakeLists.txt)
-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/generate\_polynomial\_trajectory\_behavior/CMakeLists.txt](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/generate_polynomial_trajectory_behavior/CMakeLists.txt)
-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/generate\_polynomial\_trajectory\_behavior/config/config\_default.yaml](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/generate_polynomial_trajectory_behavior/config/config_default.yaml)
-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/generate\_polynomial\_trajectory\_behavior/include/generate\_polynomial\_trajectory\_behavior/generate\_polynomial\_trajectory\_behavior.hpp](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/generate_polynomial_trajectory_behavior/include/generate_polynomial_trajectory_behavior/generate_polynomial_trajectory_behavior.hpp)
-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/generate\_polynomial\_trajectory\_behavior/launch/composable\_generate\_polynomial\_trajectory\_behavior.launch.py](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/generate_polynomial_trajectory_behavior/launch/composable_generate_polynomial_trajectory_behavior.launch.py)
-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/generate\_polynomial\_trajectory\_behavior/launch/generate\_polynomial\_trajectory\_behavior\_launch.py](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/generate_polynomial_trajectory_behavior/launch/generate_polynomial_trajectory_behavior_launch.py)
-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/generate\_polynomial\_trajectory\_behavior/src/generate\_polynomial\_trajectory\_behavior.cpp](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/generate_polynomial_trajectory_behavior/src/generate_polynomial_trajectory_behavior.cpp)
-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/generate\_polynomial\_trajectory\_behavior/src/generate\_polynomial\_trajectory\_behavior\_node.cpp](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/generate_polynomial_trajectory_behavior/src/generate_polynomial_trajectory_behavior_node.cpp)
-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/generate\_polynomial\_trajectory\_behavior/tests/CMakeLists.txt](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/generate_polynomial_trajectory_behavior/tests/CMakeLists.txt)
-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/generate\_polynomial\_trajectory\_behavior/tests/behavior\_test.py](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/generate_polynomial_trajectory_behavior/tests/behavior_test.py)
-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/generate\_polynomial\_trajectory\_behavior/tests/generate\_polynomial\_trajectory\_behavior\_gtest.cpp](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/generate_polynomial_trajectory_behavior/tests/generate_polynomial_trajectory_behavior_gtest.cpp)
-   [as2\_msgs/action/GeneratePolynomialTrajectory.action](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_msgs/action/GeneratePolynomialTrajectory.action)
-   [as2\_msgs/msg/PoseStampedWithIDArray.msg](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_msgs/msg/PoseStampedWithIDArray.msg)
-   [as2\_msgs/msg/YawMode.msg](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_msgs/msg/YawMode.msg)
-   [as2\_python\_api/as2\_python\_api/behavior\_actions/trajectory\_generation\_behavior.py](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_python_api/as2_python_api/behavior_actions/trajectory_generation_behavior.py)
-   [as2\_python\_api/as2\_python\_api/modules/trajectory\_generation\_module.py](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_python_api/as2_python_api/modules/trajectory_generation_module.py)

The Behavior System in Aerostack2 provides a framework for defining and executing robot actions (behaviors). This core component enables the creation of modular, reusable behaviors that abstract complex operations and make them available to both low-level components and high-level mission planning. This page explains the architecture and implementation of the behavior system.

For information about specific motion behaviors like takeoff and landing, see [Motion Control](https://deepwiki.com/aerostack2/aerostack2/2.3-motion-control).

## Behavior System Architecture

The Behavior System is built on ROS 2 action servers, providing a standardized way to activate, monitor, and control long-running tasks. Each behavior follows a common interface defined by the `BehaviorServer` class template, which handles the ROS 2 action server lifecycle while allowing behavior-specific logic to be implemented in derived classes.

```
Behavior System ArchitecturePerception BehaviorsTrajectory GenerationMotion BehaviorsBehavior CategoriesPointGimbalBehaviorBehaviorServerMotion BehaviorsTrajectory GenerationPerception BehaviorsTakeoffBehaviorLandBehaviorGoToBehaviorFollowPathBehaviorDynamicPolynomialTrajectoryGeneratorDetectArucoMarkersBehavior
```

Sources:

-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/generate\_polynomial\_trajectory\_behavior/include/generate\_polynomial\_trajectory\_behavior/generate\_polynomial\_trajectory\_behavior.hpp80-88](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/generate_polynomial_trajectory_behavior/include/generate_polynomial_trajectory_behavior/generate_polynomial_trajectory_behavior.hpp#L80-L88)
-   [as2\_behaviors/as2\_behaviors\_perception/point\_gimbal\_behavior/include/point\_gimbal\_behavior/point\_gimbal\_behavior.hpp63-67](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/point_gimbal_behavior/include/point_gimbal_behavior/point_gimbal_behavior.hpp#L63-L67)
-   [as2\_behaviors/as2\_behaviors\_perception/detect\_aruco\_markers\_behavior/include/detect\_aruco\_markers\_behavior/detect\_aruco\_markers\_behavior.hpp63-75](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/detect_aruco_markers_behavior/include/detect_aruco_markers_behavior/detect_aruco_markers_behavior.hpp#L63-L75)

## Behavior Lifecycle

All behaviors in Aerostack2 follow a common lifecycle that defines how they are activated, executed, modified, paused, resumed, and deactivated. This standardized interface allows for consistent interaction patterns across different behavior types.

```
Goal Receivedon_activate() returns trueon_activate() returns falseModify Goal Receivedon_modify() returns true/falseExecuteon_run() returns RUNNINGon_run() returns SUCCESSon_run() returns FAILUREPause Requestedon_pause() returns trueon_pause() returns falseResume Requestedon_resume() returns trueon_resume() returns falseCancel Requestedon_deactivate()End ExecutionEnd Executionon_execution_end()InactiveActivatingActiveFailedModifyingRunningSucceededPausingPausedResumingDeactivatingEnding
```

Sources:

-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/generate\_polynomial\_trajectory\_behavior/include/generate\_polynomial\_trajectory\_behavior/generate\_polynomial\_trajectory\_behavior.hpp161-187](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/generate_polynomial_trajectory_behavior/include/generate_polynomial_trajectory_behavior/generate_polynomial_trajectory_behavior.hpp#L161-L187)
-   [as2\_behaviors/as2\_behaviors\_perception/point\_gimbal\_behavior/include/point\_gimbal\_behavior/point\_gimbal\_behavior.hpp70-86](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/point_gimbal_behavior/include/point_gimbal_behavior/point_gimbal_behavior.hpp#L70-L86)

## Behavior Implementation

Each behavior in Aerostack2 is implemented as a class that inherits from the `BehaviorServer` template class. The base class handles the ROS 2 action server lifecycle, while the derived class implements the specific behavior logic.

```
BehaviorServer<ActionT>+bool on_activate(goal)+bool on_modify(goal)+bool on_deactivate(message)+bool on_pause(message)+bool on_resume(message)+ExecutionStatus on_run(goal, feedback, result)+void on_execution_end(status)DynamicPolynomialTrajectoryGenerator-trajectory_generator_: DynamicTrajectory-hover_motion_handler_: HoverMotion-trajectory_motion_handler_: TrajectoryMotion-tf_handler_: TfHandler-waypoints_to_set_: DynamicWaypoint::Deque+bool on_activate(goal)+bool on_modify(goal)+bool on_deactivate(message)+bool on_pause(message)+bool on_resume(message)+ExecutionStatus on_run(goal, feedback, result)+void on_execution_end(status)-bool evaluateTrajectory(eval_time)-bool evaluateSetpoint(eval_time, setpoint, current_setpoint)PointGimbalBehavior-tf_handler_: TfHandler-gimbal_name_: string-gimbal_frame_id_: string-gimbal_control_pub_: Publisher+bool on_activate(goal)+bool on_modify(goal)+bool on_deactivate(message)+bool on_pause(message)+bool on_resume(message)+ExecutionStatus on_run(goal, feedback, result)+void on_execution_end(status)-bool check_gimbal_limits(roll, pitch, yaw)-bool update_gimbal_state()
```

Sources:

-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/generate\_polynomial\_trajectory\_behavior/include/generate\_polynomial\_trajectory\_behavior/generate\_polynomial\_trajectory\_behavior.hpp80-258](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/generate_polynomial_trajectory_behavior/include/generate_polynomial_trajectory_behavior/generate_polynomial_trajectory_behavior.hpp#L80-L258)
-   [as2\_behaviors/as2\_behaviors\_perception/point\_gimbal\_behavior/include/point\_gimbal\_behavior/point\_gimbal\_behavior.hpp63-124](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/point_gimbal_behavior/include/point_gimbal_behavior/point_gimbal_behavior.hpp#L63-L124)

### Key Behavior Types

#### Trajectory Generation Behavior

The `DynamicPolynomialTrajectoryGenerator` is a central component that generates smooth polynomial trajectories for motion behaviors. It serves as the foundation for complex motion execution, allowing for precise control of the drone's position, velocity, and acceleration.

Key features:

-   Generates smooth polynomial trajectories between waypoints
-   Supports different yaw control modes (KEEP\_YAW, PATH\_FACING, FIXED\_YAW, etc.)
-   Handles dynamic trajectory regeneration when waypoints are modified
-   Provides trajectory sampling and evaluation for continuous motion control

Sources:

-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/generate\_polynomial\_trajectory\_behavior/src/generate\_polynomial\_trajectory\_behavior.cpp42-939](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/generate_polynomial_trajectory_behavior/src/generate_polynomial_trajectory_behavior.cpp#L42-L939)
-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/generate\_polynomial\_trajectory\_behavior/include/generate\_polynomial\_trajectory\_behavior/generate\_polynomial\_trajectory\_behavior.hpp80-258](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/generate_polynomial_trajectory_behavior/include/generate_polynomial_trajectory_behavior/generate_polynomial_trajectory_behavior.hpp#L80-L258)

Configuration parameters:

-   `sampling_n`: Number of trajectory points to generate per evaluation
-   `sampling_dt`: Time step between trajectory points
-   `path_length`: Maximum number of waypoints to process at once
-   `yaw_threshold`: Threshold for yaw angle changes
-   `yaw_speed_threshold`: Maximum yaw speed
-   `transform_threshold`: Threshold for transform updates

Sources:

-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/generate\_polynomial\_trajectory\_behavior/config/config\_default.yaml1-16](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/generate_polynomial_trajectory_behavior/config/config_default.yaml#L1-L16)

#### Perception Behaviors

##### Point Gimbal Behavior

The `PointGimbalBehavior` controls a gimbal to point at a specific target. It handles the coordinate transformations and gimbal control commands necessary to maintain the target in view.

Key features:

-   Takes a target position and converts it to gimbal angles
-   Enforces gimbal limits (roll, pitch, yaw)
-   Monitors gimbal state to determine when the target is in view
-   Provides feedback on current gimbal orientation

Sources:

-   [as2\_behaviors/as2\_behaviors\_perception/point\_gimbal\_behavior/src/point\_gimbal\_behavior.cpp44-378](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/point_gimbal_behavior/src/point_gimbal_behavior.cpp#L44-L378)
-   [as2\_behaviors/as2\_behaviors\_perception/point\_gimbal\_behavior/include/point\_gimbal\_behavior/point\_gimbal\_behavior.hpp63-124](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/point_gimbal_behavior/include/point_gimbal_behavior/point_gimbal_behavior.hpp#L63-L124)

Configuration parameters:

-   `gimbal_name`: Name of the gimbal to control
-   `gimbal_frame_id`: Frame ID of the gimbal
-   `gimbal_base_frame_id`: Frame ID of the gimbal base
-   `gimbal_threshold`: Threshold for determining when the target is in view
-   `roll_range`, `pitch_range`, `yaw_range`: Gimbal angle limits

Sources:

-   [as2\_behaviors/as2\_behaviors\_perception/point\_gimbal\_behavior/config/config\_default.yaml1-17](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/point_gimbal_behavior/config/config_default.yaml#L1-L17)

##### Detect ArUco Markers Behavior

The `DetectArucoMarkersBehavior` detects and tracks ArUco markers in camera images. It provides position and orientation information for detected markers.

Key features:

-   Processes camera images to detect ArUco markers
-   Estimates the 3D pose of detected markers
-   Publishes marker poses with IDs
-   Can filter markers by ID

Sources:

-   [as2\_behaviors/as2\_behaviors\_perception/detect\_aruco\_markers\_behavior/src/detect\_aruco\_markers\_behavior.cpp37-337](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/detect_aruco_markers_behavior/src/detect_aruco_markers_behavior.cpp#L37-L337)
-   [as2\_behaviors/as2\_behaviors\_perception/detect\_aruco\_markers\_behavior/include/detect\_aruco\_markers\_behavior/detect\_aruco\_markers\_behavior.hpp63-126](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_perception/detect_aruco_markers_behavior/include/detect_aruco_markers_behavior/detect_aruco_markers_behavior.hpp#L63-L126)

## Motion Behaviors with Trajectory Integration

Several motion behaviors are implemented using the trajectory generation behavior as a backend. These behaviors define high-level motion commands that are translated into trajectory generation requests.

```
Action GoalsTrajectory GeneratorMotion BehaviorsAction ClientAction ClientAction ClientAction ClientConvert toConvert toConvert toConvert totakeoff_plugin_trajectoryland_plugin_trajectorygo_to_plugin_trajectoryfollow_path_plugin_trajectoryDynamicPolynomialTrajectoryGeneratorTakeoff.GoalLand.GoalGoToWaypoint.GoalFollowPath.GoalGeneratePolynomialTrajectory.Goal
```

Sources:

-   [as2\_behaviors/as2\_behaviors\_motion/takeoff\_behavior/plugins/takeoff\_plugin\_trajectory.cpp52-228](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_motion/takeoff_behavior/plugins/takeoff_plugin_trajectory.cpp#L52-L228)
-   [as2\_behaviors/as2\_behaviors\_motion/land\_behavior/plugins/land\_plugin\_trajectory.cpp54-303](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_motion/land_behavior/plugins/land_plugin_trajectory.cpp#L54-L303)
-   [as2\_behaviors/as2\_behaviors\_motion/go\_to\_behavior/plugins/go\_to\_plugin\_trajectory.cpp54-268](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_motion/go_to_behavior/plugins/go_to_plugin_trajectory.cpp#L54-L268)
-   [as2\_behaviors/as2\_behaviors\_motion/follow\_path\_behavior/plugins/follow\_path\_plugin\_trajectory.cpp55-268](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_motion/follow_path_behavior/plugins/follow_path_plugin_trajectory.cpp#L55-L268)

## YawMode Options

The trajectory generator supports multiple yaw control modes specified in the `YawMode` message:

| YawMode ID | Name | Description |
| --- | --- | --- |
| 0 | KEEP\_YAW | Maintain the current yaw angle |
| 1 | PATH\_FACING | Align yaw with the direction of travel |
| 2 | FIXED\_YAW | Set yaw to a specified absolute angle |
| 3 | YAW\_FROM\_TOPIC | Get yaw angle from a topic |
| 4 | YAW\_FROM\_ORIENTATION | Set yaw from the pose orientation |
| 5 | YAW\_TO\_FRAME | Point yaw towards a reference frame |
| 6 | FACE\_REFERENCE | Point yaw towards the next waypoint |

Sources:

-   [as2\_msgs/msg/YawMode.msg1-12](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_msgs/msg/YawMode.msg#L1-L12)
-   [as2\_behaviors/as2\_behaviors\_trajectory\_generation/generate\_polynomial\_trajectory\_behavior/src/generate\_polynomial\_trajectory\_behavior.cpp631-664](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_trajectory_generation/generate_polynomial_trajectory_behavior/src/generate_polynomial_trajectory_behavior.cpp#L631-L664)

## Python API Integration

The behavior system is exposed to users through the Python API, which provides an intuitive interface for activating and controlling behaviors.

```
ROS 2 Action SystemAS2 Python APIUser CodeBehavior ActionsBehavior ModulesUser Python ScriptDroneInterfaceModuleBaseTrajectoryGenerationModuleTakeoffModuleLandModuleGoToModuleBehaviorHandlerTrajectoryGenerationBehaviorROS 2 Action ClientBehavior Action Server
```

Example usage in Python:

```
# Import the drone interface
from as2_python_api.drone_interface import DroneInterface

# Create a drone interface object
drone = DroneInterface()

# Generate a trajectory
path = [(0.0, 0.0, 1.0), (1.0, 0.0, 1.0), (1.0, 1.0, 1.0)]
drone.trajectory_generation(
    path=path,
    speed=0.5,
    yaw_mode=YawMode.PATH_FACING,
    frame_id="earth"
)
```

Sources:

-   [as2\_python\_api/as2\_python\_api/modules/trajectory\_generation\_module.py56-137](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_python_api/as2_python_api/modules/trajectory_generation_module.py#L56-L137)
-   [as2\_python\_api/as2\_python\_api/behavior\_actions/trajectory\_generation\_behavior.py50-164](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_python_api/as2_python_api/behavior_actions/trajectory_generation_behavior.py#L50-L164)

## Behavior Composition

A key strength of the behavior system is the ability to compose complex behaviors from simpler ones. For example, motion behaviors like takeoff, land, and go\_to can use the trajectory generation behavior to provide smooth motion execution.

```
Motion ControlCore BehaviorsHigh-Level BehaviorsUsesUsesUsesUsesPublishesConsumed byTakeoffBehaviorLandBehaviorGoToBehaviorFollowPathBehaviorDynamicPolynomialTrajectoryGeneratorTrajectorySetpointsMotionController
```

Sources:

-   [as2\_behaviors/as2\_behaviors\_motion/takeoff\_behavior/plugins/takeoff\_plugin\_trajectory.cpp52-228](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_motion/takeoff_behavior/plugins/takeoff_plugin_trajectory.cpp#L52-L228)
-   [as2\_behaviors/as2\_behaviors\_motion/land\_behavior/plugins/land\_plugin\_trajectory.cpp54-303](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_motion/land_behavior/plugins/land_plugin_trajectory.cpp#L54-L303)
-   [as2\_behaviors/as2\_behaviors\_motion/go\_to\_behavior/plugins/go\_to\_plugin\_trajectory.cpp54-268](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_motion/go_to_behavior/plugins/go_to_plugin_trajectory.cpp#L54-L268)
-   [as2\_behaviors/as2\_behaviors\_motion/follow\_path\_behavior/plugins/follow\_path\_plugin\_trajectory.cpp55-268](https://github.com/aerostack2/aerostack2/blob/10200cd9/as2_behaviors/as2_behaviors_motion/follow_path_behavior/plugins/follow_path_plugin_trajectory.cpp#L55-L268)

## Conclusion

The Behavior System is a central component of Aerostack2 that provides a flexible framework for implementing autonomous drone behaviors. By standardizing the behavior interface and lifecycle, it enables behavior composition and reuse, making it easier to develop complex autonomous drone applications.